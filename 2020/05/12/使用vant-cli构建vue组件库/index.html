<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="王羽彪"><title>使用vant-cli构建vue组件库 · 南城旧梦</title><meta name="description" content="构建参考vant开发人员提供的demo：
vant-cli demo 
遇到的问题问题：搭建好demo后，用vue-cli构建一个vue项目，用yarn link引用vant-cli demo项目. Home.vue代码如下:

在vue-cli项目中运行yarn build，发现打包好发现有js文"><meta name="keywords" content="前端学习 前端总结 笔记 生活 王羽彪"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="../../../../css/style.css"><link rel="stylesheet" href="../../../../css/blog_basic.css"><link rel="stylesheet" href="../../../../css/font-awesome.min.css"><link rel="stylesheet" href="../../../../css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="../../../../images/logo@2x.png" style="width:127px;"><h3 title><a href="/">南城旧梦</a></h3><div class="description"><p>多看、多写、多做总结，寻找价值！</p></div></div></div><ul class="social-links"><li><a href="http://github.com/nanchengjiumeng"><i class="fa fa-github"></i></a></li></ul><div class="tags-links"><a href="/tags/html"><i>html</i></a><a href="/tags/javascript"><i>javascript</i></a><a href="/tags/css"><i>css</i></a><a href="/tags/nodejs"><i>nodejs</i></a><a href="/tags/database"><i>database</i></a><a href="/tags/vue"><i>vue</i></a><a href="/tags/article"><i>article</i></a><a href="/tags/vue vant vant-cli"><i>vue vant vant-cli</i></a><a href="/tags/economist"><i>economist</i></a></div><div class="footer"><div class="by_farbox"></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="navi"><li><a href="/">首页</a></li><li><a href="/archives">归档</a></li><li> <a href="https://topschoolwangyubia.github.io/">旧文章</a></li><li><a href="/about">关于</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><a href="/"><img src="/images/logo.png"></a></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>使用vant-cli构建vue组件库</a></h3></div><div class="post-content"><h1 id="构建"><a href="#构建" class="headerlink" title="构建"></a>构建</h1><p>参考vant开发人员提供的demo：</p>
<p><a href="https://github.com/youzan/vant-demo/tree/master/vant-cli/base" target="_blank" rel="noopener">vant-cli demo</a> </p>
<h1 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h1><p>问题：搭建好demo后，用vue-cli构建一个vue项目，用<code>yarn link</code>引用vant-cli demo项目. <code>Home.vue</code>代码如下:</p>
<p><img src="/iamges/vant-cli/vant-cli-demo-1.png" alt="代码"></p>
<p>在vue-cli项目中运行<code>yarn build</code>，发现打包好发现有js文件的大小有200kb左右，vue不到80kb，vue-route 30kb左右，这样算一个空项目不应该有真么大。用<code>webpack-bundle-analyzer</code>分析一下：</p>
<p><img src="/iamges/vant-cli/vant-cli-modules-repeat.png" alt="webpack-bundle-analyzer 结果"></p>
<p>居然打包后文件里有两份vue代码. 排查后发现当vant-cli组件库下的node_modules中包含vue的时候，会多打包处一份vue代码，具体原因没找到。</p>
<p>当组件库发不到npm后，用<code>npm install</code>安装不会包含<code>node_modules</code>，所以这个问题不影响正常使用包。</p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2020-05-12</span><i class="fa fa-tag"></i><a class="tag" href="/tags/vue-vant-vant-cli/" title="vue vant vant-cli">vue vant vant-cli </a></div></div></div></div><button class="animated fadeInDown navbar-toggle" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="navbar-collapse" aria-expanded="false"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div class="table-of-content animated fadeInDown" id="bs-navbar"><h1 class="title">目录</h1><p class="table_level_1"><a href="#构建" class="headerlink" title="构建">构建</a></p><p class="table_level_1"><a href="#遇到的问题" class="headerlink" title="遇到的问题">遇到的问题</a></p></div><div class="pagination"><ul class="clearfix"><li class="next pagbuttons"><a class="btn" role="navigation" href="../../../../2019/05/14/经济学人精选-1/" title="经济学人精选 1">下一篇</a></li></ul></div></div></div></div></div><script src="../../../../js/jquery.js"></script><script src="../../../../js/jquery-migrate-1.2.1.min.js"></script><script src="../../../../js/jquery.appear.js"></script><script src="../../../../js/tableOfContent.js"></script></body></html>